<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="en">
<head>
    <th:block th:replace="fragments/header :: header-meta"></th:block>

    <title data-th-text="${event.title}"></title>
    <link th:href="@{/css/event.css}" rel="stylesheet" />
</head>
<body>
<div class="wrapper">
    <div th:replace="fragments/header :: main-header"></div>
    <div class="background-1-article">
        <div class="event-title-photo">
            <img th:src="${event.titleImage}" th:alt="${event.title + ' ' + event.announcement}">
            <div class="event-title-content-box">
                <div class="event-title-text" th:text="${event.title}"></div>
                <div class="event-title-address-date-field">
                    <div class="event-map-pin-icon"></div>
                    <div class="address" th:text="${event.city + ', ' + event.address}"></div>
                    <div class="event-clock-icon"></div>
                    <div class="time" th:text="${dateFormatter.get(event.dateTime)}"></div>
                </div>
                <div class="event-title-torn-edge"></div>
            </div>
        </div>
    </div>
    <div class="background-2-history">
        <div class="event-title-text-field">
            <div class="event-title" th:text="${event.descriptionTitle}"></div>
            <iframe class="event-video" width="720" height="405" th:src="${event.videoLink}" style="border: none;" allow="clipboard-write; autoplay" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
            <div class="event-description" th:utext="${event.description}"></div>
        </div>
    </div>
    <div class="background-2-event">
        <div th:each="photo, iterStat : ${event.getAlbum().getPhotos()}"
             th:id="'open-modal' + ${iterStat.index}" class="event-modal-window">
            <div class="modal-content-wrapper">
                <!-- Кнопка Закрыть -->
                <a th:href="|/event/${event.id}#photos|" title="Закрыть" class="event-modal-close">×</a>

                <!-- Стрелка НАЗАД (не показываем на самом первом фото) -->
                <a th:if="${!iterStat.first}"
                   th:href="'#open-modal' + ${iterStat.index - 1}"
                   class="modal-nav-btn prev-btn">‹</a>

                <!-- Само ФОТО -->
                <img th:src="${photo.path}" class="modal-image">

                <!-- Стрелка ВПЕРЕД (не показываем на самом последнем фото) -->
                <a th:if="${!iterStat.last}"
                   th:href="'#open-modal' + ${iterStat.index + 1}"
                   class="modal-nav-btn next-btn">›</a>
            </div>
        </div>
        <div class="event-photo-field" id=photos>
            <div class="event-photo-title">
                <text>Фото с мероприятия</text>
            </div>
            <div class="event-photo-album">
                <a th:each="photo, iterStat : ${event.getAlbum().getPhotos()}"
                th:class="${iterStat.first} ? 'first-photo-card' : 'photo-card'"
                th:href="'#open-modal' + ${iterStat.index}">
                    <img th:src="${photo.path}">
                </a>
            </div>
        </div>
        <div class="event-transition-field">
            <!-- БЛОК НАЗАД (Кнопка ПЕРЕД текстом) -->
            <div class="event-transition-backward-forward-field">
                <div class="transition-wrapper">
                    <a th:href="@{/events#events}" class="event-transition-backward-btn"></a>
                    <div class="event-transition-backward-title">Анонсы</div>
                </div>
            </div>

            <!-- БЛОК ВПЕРЕД (Текст ПЕРЕД кнопкой) -->
            <div class="event-transition-backward-forward-field" th:if="${event.dateTime.isBefore(eventsSortedList.get(eventsSortedList.size() - 1).dateTime)}">
                <div class="transition-wrapper">
                    <div class="event-transition-forward-title">Следующее мероприятие</div>
                    <a th:href="|/event/${eventsSortedList.get(eventsSortedList.indexOf(event) + 1).id}|"
                       class="event-transition-forward-btn"></a>
                </div>
            </div>
        </div>
    </div>
</div>
<div th:replace="fragments/footer :: main-footer"></div>
</body>
</html>